<!DOCTYPE html>
<html lang="id" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Deep Thinker AI - Material</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        /* --- CSS VARIABLES FOR THEMING --- */
        :root {
            --bg-color: #f5f5f5;
            --text-color: #333333;
            --chat-bg: #ffffff;
            --input-bg: #ffffff;
            --border-color: #dbdbdb;
            --user-bubble: #2196f3; /* Material Blue */
            --user-text: #ffffff;
            --ai-bubble: #e0e0e0;
            --ai-text: #333333;
            --shadow: 0 2px 5px rgba(0,0,0,0.1);
            --nav-bg: #ffffff;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --chat-bg: #1e1e1e;
            --input-bg: #2c2c2c;
            --border-color: #333333;
            --user-bubble: #bb86fc; /* Material Purple */
            --user-text: #121212;
            --ai-bubble: #333333;
            --ai-text: #e0e0e0;
            --shadow: 0 2px 8px rgba(0,0,0,0.5);
            --nav-bg: #1e1e1e;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Roboto', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* --- NAVBAR --- */
        .navbar {
            background-color: var(--nav-bg);
            box-shadow: var(--shadow);
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease;
        }
        .navbar-item, .title {
            color: var(--text-color) !important;
        }

        /* --- CHAT AREA --- */
        .main-content {
            flex-grow: 1;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            max-width: 1000px;
            margin: 0 auto;
            width: 100%;
        }

        #chat-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            scroll-behavior: smooth;
        }

        /* Scrollbar styling */
        #chat-container::-webkit-scrollbar { width: 6px; }
        #chat-container::-webkit-scrollbar-track { background: transparent; }
        #chat-container::-webkit-scrollbar-thumb { background: rgba(128,128,128,0.5); border-radius: 3px; }

        /* --- MESSAGES --- */
        .message-wrapper {
            display: flex;
            margin-bottom: 20px;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
        }
        
        @keyframes fadeIn { to { opacity: 1; } }

        .message-wrapper.user { justify-content: flex-end; }
        .message-wrapper.assistant { justify-content: flex-start; }

        .chat-bubble {
            max-width: 85%;
            padding: 12px 18px;
            border-radius: 12px;
            position: relative;
            box-shadow: var(--shadow);
            font-size: 0.95rem;
            line-height: 1.6;
            word-wrap: break-word;
        }

        .user .chat-bubble {
            background-color: var(--user-bubble);
            color: var(--user-text);
            border-bottom-right-radius: 2px;
        }

        .assistant .chat-bubble {
            background-color: var(--ai-bubble);
            color: var(--ai-text);
            border-bottom-left-radius: 2px;
        }

        /* Output Formatting */
        .assistant strong { color: inherit; font-weight: 700; }
        .assistant ul, .assistant ol { margin-left: 20px; margin-top: 5px; }
        .assistant code { background: rgba(0,0,0,0.2); padding: 2px 5px; border-radius: 4px; color: inherit; }

        /* --- INPUT AREA --- */
        .input-area {
            background-color: var(--nav-bg);
            padding: 15px;
            border-top: 1px solid var(--border-color);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }

        .input-custom {
            background-color: var(--input-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
            transition: border 0.3s;
        }
        
        .input-custom:focus {
            border-color: var(--user-bubble);
            box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
        }
        
        .input-custom::placeholder { color: #888; }

        .btn-send {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--user-bubble);
            color: var(--user-text);
            border: none;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-left: 10px;
        }

        .btn-send:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
            color: var(--user-text);
        }
        
        .btn-send:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* --- THEME TOGGLE BTN --- */
        #theme-toggle {
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
            color: var(--text-color);
            background: transparent;
            border: none;
        }
        #theme-toggle:hover {
            background-color: rgba(128,128,128,0.2);
        }

    </style>
</head>
<body>

    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="container">
            <div class="navbar-brand">
                <a class="navbar-item" href="#">
                    <span class="icon is-medium" style="margin-right: 5px;">
                        <i class="fas fa-brain fa-lg"></i>
                    </span>
                    <h1 class="title is-5" style="margin-bottom: 0;">Deep Thinker AI</h1>
                </a>

                <a role="button" class="navbar-item is-hidden-desktop" style="margin-left: auto;" id="theme-toggle-mobile">
                    <i class="fas fa-moon"></i>
                </a>
            </div>

            <div class="navbar-menu">
                <div class="navbar-end">
                    <div class="navbar-item">
                         <button id="theme-toggle-desktop" title="Ganti Tema">
                            <i class="fas fa-moon"></i>
                         </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div id="chat-container">
            <div class="message-wrapper assistant">
                <div class="chat-bubble">
                    <strong>Sistem Online (Llama 3.3).</strong><br>
                    Mode analisis kritis siap. Silakan sampaikan pertanyaan Anda.
                </div>
            </div>
        </div>

        <div class="input-area">
            <div class="container">
                <form onsubmit="sendMessage(event)" style="display: flex; align-items: center;">
                    <div class="control is-expanded">
                        <input class="input input-custom" type="text" id="user-input" placeholder="Ketik topik diskusi di sini..." autocomplete="off">
                    </div>
                    <button type="submit" class="button btn-send" id="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // --- KONFIGURASI API ---
        const MY_API_KEY = "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";
        // -----------------------

        const SYSTEM_PROMPT = `
Tugasmu adalah tidak hanya memberikan jawaban, tapi juga menunjukkan cara berpikir logis, mempertimbangkan berbagai sudut pandang, dan menguji argumen secara kritis. Saat menjawab, gunakan pendekatan seperti seorang peneliti, filsuf, dan problem-solver profesional.

Gunakan struktur berpikir eksplisit:
1. Analisis masalah / pertanyaan utama
2. Identifikasi asumsi tersembunyi
3. Kaji alternatif atau kontra-argumen
4. Tarik kesimpulan logis
5. Insight tambahan.

Jika data kurang, buat hipotesis masuk akal. Prioritaskan kedalaman pemikiran.
        `;

        const chatContainer = document.getElementById('chat-container');
        const sendBtn = document.getElementById('send-btn');
        const userInput = document.getElementById('user-input');

        // --- DARK MODE LOGIC ---
        const htmlElement = document.documentElement;
        const toggleDesktop = document.getElementById('theme-toggle-desktop');
        const toggleMobile = document.getElementById('theme-toggle-mobile');
        
        function updateIcon(isDark) {
            const iconClass = isDark ? 'fa-sun' : 'fa-moon';
            toggleDesktop.innerHTML = `<i class="fas ${iconClass}"></i>`;
            toggleMobile.innerHTML = `<i class="fas ${iconClass}"></i>`;
        }

        function toggleTheme() {
            const currentTheme = htmlElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            htmlElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateIcon(newTheme === 'dark');
        }

        // Load Saved Theme
        const savedTheme = localStorage.getItem('theme') || 'dark';
        htmlElement.setAttribute('data-theme', savedTheme);
        updateIcon(savedTheme === 'dark');

        toggleDesktop.addEventListener('click', toggleTheme);
        toggleMobile.addEventListener('click', toggleTheme);

        // --- CHAT LOGIC ---
        async function sendMessage(e) {
            e.preventDefault();
            const text = userInput.value.trim();
            if (!text) return;

            // UI Updates
            userInput.disabled = true;
            sendBtn.disabled = true;
            appendMessage(text, 'user');
            userInput.value = '';

            // Loading Indicator
            const loadingId = appendMessage('<i class="fas fa-circle-notch fa-spin"></i> Sedang menganalisis...', 'assistant', true);

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${MY_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        messages: [
                            { role: "system", content: SYSTEM_PROMPT },
                            { role: "user", content: text }
                        ],
                        model: "llama-3.3-70b-versatile",
                        temperature: 0.6,
                        max_tokens: 4096
                    })
                });

                const data = await response.json();
                
                // Remove loading
                const loadingDiv = document.getElementById(loadingId);
                if(loadingDiv) loadingDiv.parentElement.remove(); // Remove wrapper

                if (data.error) {
                    appendMessage('Error API: ' + data.error.message, 'assistant');
                } else {
                    let aiReply = data.choices[0].message.content;
                    // Formating sederhana
                    aiReply = aiReply.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    aiReply = aiReply.replace(/\n/g, '<br>');
                    appendMessage(aiReply, 'assistant', true);
                }

            } catch (error) {
                const loadingDiv = document.getElementById(loadingId);
                if(loadingDiv) loadingDiv.parentElement.remove();
                appendMessage('Gagal koneksi. Cek internet.', 'assistant');
            } finally {
                userInput.disabled = false;
                sendBtn.disabled = false;
                userInput.focus();
            }
        }

        function appendMessage(text, role, isHtml = false) {
            const wrapper = document.createElement('div');
            wrapper.className = `message-wrapper ${role}`;
            
            const bubble = document.createElement('div');
            bubble.className = 'chat-bubble';
            bubble.id = Math.random().toString(36).substr(2, 9);
            
            if (isHtml) {
                bubble.innerHTML = text;
            } else {
                bubble.innerText = text;
            }
            
            wrapper.appendChild(bubble);
            chatContainer.appendChild(wrapper);
            
            // Auto Scroll ke bawah
            setTimeout(() => {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 50);

            return bubble.id;
        }
    </script>
</body>
</html>
